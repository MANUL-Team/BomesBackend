## Деплой проекта  

Все развернуто на 2 нодах k3s: devbomes и devbomes2. Все поды имеют по 2 реплики на каждой ноде соответственно.

Для каждого пода выведены сервисы. В будущем возможно их стоит убрать(кроме api), но пока для удобства оставлены. Обращаться через `{Название пода}-service`

Настроен CI сборки образа каждого сервиса и rollout restart для деплоя. Обновление будет происходить поочередно для каждой реплики пода. Образы хранятся в локальном registry `bomes-hub:5000` в формате `bomes-hub:5000/$DOCKERNAME`

Фронтенд собирается отдельным образом в отдельном проекте и также кладется на дев кластер.

### RabbitMQ

Rabbitmq собран в кластер из 3 подов. Хранение данных временно прокинуто на хостовые директории /opt/rabbitmq-*.

Связь внутри кластера между подами сделана через сервис `rabbitmq`. Соответственно, обращаться к кластеру кролика нужно через него.

Management порт для удобства работы выведен наружу через ingress. Доступен по ссылке `http://rabbitmq-dev.bomes.ru:15672`. Логин пароль дефолтные guest/guest.

### Дашборд k3s

Поднят дашборд для наглядной работы в k3s. Чтобы в него зайти нужно:

```
kubectl get secret admin-user -n kubernetes-dashboard -o jsonpath="{.data.token}" | base64 -d
```

Скопировать токен из секрета.

Пробросить порт во внутрь пода фронта.

```
kubectl -n kubernetes-dashboard port-forward svc/kubernetes-dashboard-kong-proxy 8443:443
```

Если делать локально на рабочей машине, то он будет доступен по url `https://localhost:8443`. Внутри вставляем токен авторизации.